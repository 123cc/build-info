apply id: 'java'
group = 'org.jfrog.buildinfo'
version = '1.1-SNAPSHOT'

/*
(5) Define the Maven attributes that will be used for POM auto-generation
 */
def artifactId = 'buildinfo'
def groupId = group
def versionNumber = version


subprojects {
  apply id: 'java'
  apply id: 'maven'
  apply url: 'http://gradle.artifactoryonline.com/gradle/plugins-releases-local/artifactoryplugin/artifactoryplugin/0.3/artifactoryplugin-0.3.gradle'

  dependencies {
    compile group: 'commons-lang', name: 'commons-lang', version: '2.4'
    compile group: 'commons-logging', name: 'commons-logging', version: '1.1.1'
    testCompile group: 'org.testng', name: 'testng', version: '5.11', classifier: 'jdk15'
  }
}

project(':build-info-api') {
  dependencies {
    compile group: 'commons-codec', name: 'commons-codec', version: '1.3'
    compile group: 'com.thoughtworks.xstream', name: 'xstream', version: '1.3.1'
    compile group: 'com.google.collections', name: 'google-collections', version: '1.0'
  }
}

project(':build-info-client') {
  dependencies {
    compile project(':build-info-api')
    compile group: 'org.codehaus.jackson', name: 'jackson-mapper-asl', version: '1.4.1'
    compile group: 'org.codehaus.jackson', name: 'jackson-core-asl', version: '1.4.1'
    compile group: 'org.apache.httpcomponents', name: 'httpclient', version: '4.0.1'
    compile group: 'org.apache.httpcomponents', name: 'httpcore', version: '4.0.1'
  }
}


dependsOnChildren()

uploadArchives {
  repositories {
    /*
   (6) This will be used to deploy the Gradle artifact and ivy modules
    */

    mavenRepo urls: "http://localhost:8080/artifactory/libs-snapshots-local";
    org.apache.ivy.util.url.CredentialsStore.INSTANCE.addCredentials(REALM, HOST, USER, PASSWORD)

    /*
   (3) Use this to also deploy an auto-generated POM
    */

    repositories.mavenDeployer {
      repository(url: "http://localhost:8080/artifactory/libs-snapshots-local") {
        /*
       (4) The login/password of an Artifactory user with deploy privileges.
       USER and PASSWORD are coming from gradle.properties
        */

        authentication(userName: USER, password: PASSWORD)
      }
      /*  pom.version = versionNumber
    pom.artifactId = artifactId
    pom.groupId = groupId*/
    }
  }
}
